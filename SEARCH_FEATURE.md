# 搜索功能使用说明

## 功能概述

插件新增了强大的智能搜索功能，支持：
- ✅ 直接文本匹配
- ✅ 拼音搜索（拼音首字母和完整拼音）
- ✅ 模糊搜索（基于编辑距离）
- ✅ 轻量级向量式搜索（字符重叠相似度）

## 使用方法

### 1. 打开搜索界面

1. 打开插件工具窗口
2. 点击 **"搜索"** 标签页
3. 在搜索框中输入关键词

### 2. 搜索示例

假设你有以下TopicLine注释：
- "如家的1"
- "如家的2"
- "如家酒店服务"

**直接匹配：**
- 输入 `如家` → 匹配所有包含"如家"的结果

**拼音首字母：**
- 输入 `rjd` → 匹配 "如家的1"、"如家的2"

**完整拼音：**
- 输入 `rujia` → 匹配 "如家"

**模糊匹配：**
- 输入 `如家1` → 也能匹配到 "如家的2"（编辑距离相近）

### 3. 交互操作

#### 方式1：双击跳转到代码
- **双击** 搜索结果项 → 立即在编辑器中打开对应的代码文件并定位到具体行

#### 方式2：右键菜单
- **右键点击** 搜索结果项 → 显示上下文菜单：
  - **跳转到代码** 📝 - 在编辑器中打开代码
  - **在树视图中定位** 📍 - 在树视图中展开并高亮对应的TopicLine

#### 方式3：键盘快捷键
- **回车键** - 跳转到代码
- **↓** 键（在搜索框中）- 将焦点移到结果列表

### 4. 搜索结果显示

每个搜索结果显示以下信息：
```
[Topic名称] ▸ [Group名称] ▸ 中文注释 (文件路径:行号) 相似度%
```

- **Topic名称** - 蓝色显示
- **Group名称** - 紫色显示（未分组则显示灰色"未分组"）
- **中文注释** - 加粗显示
- **文件路径:行号** - 灰色显示
- **相似度评分** - 颜色编码：
  - 🟢 绿色 (>70%) - 高度匹配
  - 🟠 橙色 (40-70%) - 中度匹配
  - 🔴 红色 (<40%) - 低度匹配

### 5. 状态栏信息

搜索框下方的状态栏会显示：
- 搜索结果数量：`找到 X 个结果`
- 无结果时：`未找到匹配的结果`
- 错误信息（如果有）

## 技术特性

### 相似度算法

搜索服务使用多种算法综合评分：

1. **完全匹配** (100分) - 文本完全相同
2. **包含匹配** (60-100分) - 根据位置和覆盖率评分
3. **拼音匹配** (50-55分) - 拼音首字母或完整拼音匹配
4. **编辑距离** (0-40分) - Levenshtein距离算法
5. **字符重叠** (0-30分) - 字符重叠比例

最终取最高分作为相似度评分。

### 实时搜索

- 输入时自动触发搜索
- 结果按相似度降序排序
- 只显示评分 > 10% 的结果

## 注意事项

1. **搜索范围**：仅搜索TopicLine的note（中文注释）内容，不搜索代码本身
2. **性能**：大量TopicLine时，搜索可能需要一点时间（后台异步执行）
3. **自动更新**：当Topic或TopicLine变化时，搜索数据会自动更新

## 常见问题

**Q: 为什么搜索不到某些内容？**
A: 确保该TopicLine有note（中文注释），搜索只匹配note字段。

**Q: 双击没有反应？**
A: 确保对应的代码文件仍然存在且路径正确。

**Q: 如何清除搜索？**
A: 点击搜索框右侧的 ✕ 按钮，或直接删除搜索框中的文本。

## 快捷键总结

| 操作 | 快捷键 |
|------|--------|
| 跳转到代码 | 双击 或 回车 |
| 显示上下文菜单 | 右键点击 |
| 移动到结果列表 | ↓（在搜索框中）|
| 清除搜索 | 点击 ✕ 按钮 |

